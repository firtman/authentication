{"pageProps":{"post":{"attributes":{},"html":"<h1 id=\"registering-a-new-authorization-with-webauthn\">Registering a new Authorization with WebAuthn</h1>\n<p>In our HTML, let&#39;s add some code in the <code>account</code> view</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">section</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;webauthn&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onclick</span>=<span class=\"hljs-string\">&quot;Auth.addWebAuthn()&quot;</span>&gt;</span>Add Authenticator / Passkey<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">section</span>&gt;</span>\n</code></pre>\n<p>Then in Auth.js we add</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">addWebAuthn</span>: <span class=\"hljs-keyword\">async</span> () =&gt; {           \n    <span class=\"hljs-keyword\">const</span> options = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable constant_\">API</span>.<span class=\"hljs-property\">webAuthn</span>.<span class=\"hljs-title function_\">registrationOptions</span>();        \n    options.<span class=\"hljs-property\">authenticatorSelection</span>.<span class=\"hljs-property\">residentKey</span> = <span class=\"hljs-string\">&#x27;required&#x27;</span>;\n    options.<span class=\"hljs-property\">authenticatorSelection</span>.<span class=\"hljs-property\">requireResidentKey</span> = <span class=\"hljs-literal\">true</span>;\n    options.<span class=\"hljs-property\">extensions</span> = {\n        <span class=\"hljs-attr\">credProps</span>: <span class=\"hljs-literal\">true</span>,\n    };\n    <span class=\"hljs-keyword\">const</span> authRes = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title class_\">SimpleWebAuthnBrowser</span>.<span class=\"hljs-title function_\">startRegistration</span>(options);\n    <span class=\"hljs-keyword\">const</span> verificationRes = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable constant_\">API</span>.<span class=\"hljs-property\">webAuthn</span>.<span class=\"hljs-title function_\">registrationVerification</span>(authRes);\n    <span class=\"hljs-keyword\">if</span> (verificationRes.<span class=\"hljs-property\">ok</span>) {\n        <span class=\"hljs-title function_\">alert</span>(<span class=\"hljs-string\">&quot;You can now login using the registered method!&quot;</span>);\n    } <span class=\"hljs-keyword\">else</span> {\n        <span class=\"hljs-title function_\">alert</span>(verificationRes.<span class=\"hljs-property\">message</span>)\n    }\n},\n</code></pre>\n","slug":"registering-authentication","title":"Registering Authentication","section":"Using Webauthn","icon":"fingerprint","filePath":"/Users/firt/Library/Mobile Documents/com~apple~CloudDocs/Trainings/FEM/Authentication/fullstack-authentication/lessons/05-using-webauthn/D-registering-authentication.md","nextSlug":"/authentication/lessons/using-webauthn/authorizing","prevSlug":"/authentication/lessons/using-webauthn/setting-up-endpoints"}},"__N_SSG":true}